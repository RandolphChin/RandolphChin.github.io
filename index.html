<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="author" content="John Doe">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Hexo"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Hexo</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header page-header-inverse ">
  <h1 class="title title-inverse ">Hexo</h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">
      <i class="fa fa-heart"></i>
      Welcome to Randolph Chin&#39;s Home.
</div>    
		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-27 </div>
			<div class="article-title"><a href="/2018/06/27/sqlplus创建用户表空间赋权/" >sqlplus创建用户表空间赋权</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h4 id="1st-CMD进入DBA"><a href="#1st-CMD进入DBA" class="headerlink" title="1st CMD进入DBA"></a>1st CMD进入DBA</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlplus /nolog</span><br></pre></td></tr></table></figure>
<p>sqlplus /nolog只是登录进了SQLPLUS,此时并没有登录数据库<br>所以需要再用connect username/password连接上数据库 </p>
<h4 id="连接-sysdba"><a href="#连接-sysdba" class="headerlink" title="连接 sysdba"></a>连接 sysdba</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn / as sysdba</span><br></pre></td></tr></table></figure>
<h3 id="2nd-创建用户"><a href="#2nd-创建用户" class="headerlink" title="2nd 创建用户"></a>2nd 创建用户</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create user username identified by password;</span><br></pre></td></tr></table></figure>
<h3 id="3rd-授权"><a href="#3rd-授权" class="headerlink" title="3rd 授权"></a>3rd 授权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant dba,connect to username;</span><br></pre></td></tr></table></figure>
<h4 id="4th-创建表空间"><a href="#4th-创建表空间" class="headerlink" title="4th 创建表空间"></a>4th 创建表空间</h4><p>创建表结构时，有时候需要先创建 Tablespaces 表空间，命令如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create tablespace TQDC_DATA</span><br><span class="line">datafile &apos;D:\app\Administrator\oradata\orcl\TQDC_DATA.DBF&apos; size 500M</span><br><span class="line">autoextend on next 100M maxsize unlimited logging</span><br><span class="line">extent management local autoallocate</span><br><span class="line">segment space management auto;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>DATAFILE: 表空间数据文件存放路径</li>
<li>SIZE: 起初设置为200M</li>
<li>UNIFORM: 指定区尺寸为128k,如不指定，区尺寸默认为64k<h4 id="5th-表空间分配给用户"><a href="#5th-表空间分配给用户" class="headerlink" title="5th 表空间分配给用户"></a>5th 表空间分配给用户</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter user zzg default tablespace TQDC_DATA;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h4 id="查看表空间的名字及文件所在位置"><a href="#查看表空间的名字及文件所在位置" class="headerlink" title="查看表空间的名字及文件所在位置"></a>查看表空间的名字及文件所在位置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select tablespace_name, file_id, file_name,</span><br><span class="line">round(bytes/(1024*1024),0) total_space</span><br><span class="line">from dba_data_files</span><br><span class="line">order by tablespace_name</span><br></pre></td></tr></table></figure>
<h4 id="查看当前-schema-下所有表的表名及表占用大小"><a href="#查看当前-schema-下所有表的表名及表占用大小" class="headerlink" title="查看当前 schema 下所有表的表名及表占用大小"></a>查看当前 schema 下所有表的表名及表占用大小</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select segment_name,bytes/1024/1024  from user_segments order by  bytes desc</span><br></pre></td></tr></table></figure>
<h4 id="查询表空间使用情况"><a href="#查询表空间使用情况" class="headerlink" title="查询表空间使用情况"></a>查询表空间使用情况</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select a.tablespace_name,a.bytes/1024/1024 &quot;sum MB&quot;,</span><br><span class="line">(a.bytes-b.bytes)/1024/1024 &quot;used MB&quot;,b.bytes/1024/1024 &quot;free MB&quot;,</span><br><span class="line">round (((a.bytes-b.bytes)/a.bytes)*100,2) &quot;used%&quot; from</span><br><span class="line">(select tablespace_name,sum(bytes) bytes from dba_data_files group by tablespace_name) a,</span><br><span class="line">(select tablespace_name,sum(bytes) bytes,max (bytes) largest from dba_free_space group by tablespace_name)b</span><br><span class="line">where a.tablespace_name=b.tablespace_name</span><br><span class="line">order by ((a.bytes-b.bytes)/a.bytes) desc;</span><br></pre></td></tr></table></figure>
<h4 id="Method-1-增大所需表空间大小"><a href="#Method-1-增大所需表空间大小" class="headerlink" title="Method 1 增大所需表空间大小"></a>Method 1 增大所需表空间大小</h4><p>语法： alter database datafile ‘表空间位置’resize 新的尺寸<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter database datafile &apos;\oracle\oradata\anita_2008.dbf&apos; resize 4000m</span><br></pre></td></tr></table></figure></p>
<h4 id="Method-2-增加数据文件个数"><a href="#Method-2-增加数据文件个数" class="headerlink" title="Method 2 增加数据文件个数"></a>Method 2 增加数据文件个数</h4><p>语法： alter tablespace 表空间名称 add datafile ‘新的数据文件地址’ size 数据文件大小<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter tablespace YOUR_TABLESPECA_NAME</span><br><span class="line"> add datafile &apos;\oracle\oradata\anita_2010.dbf&apos; size 1000m</span><br></pre></td></tr></table></figure></p>
<h4 id="Method-3表空间自动扩展"><a href="#Method-3表空间自动扩展" class="headerlink" title="Method 3表空间自动扩展"></a>Method 3表空间自动扩展</h4><p>语法： alter database datafile ‘数据文件位置’ autoextend on next 自动扩展大小 maxsize 最大扩展大小<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter database datafile &apos;\oracle\oradata\anita_2008.dbf&apos;</span><br><span class="line">  autoextend on next 100m maxsize 10000m</span><br></pre></td></tr></table></figure></p>

	
	</div>
  <a type="button" href="/2018/06/27/sqlplus创建用户表空间赋权/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-25 </div>
			<div class="article-title"><a href="/2018/06/25/调用Http服务/" >调用Http服务</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p> http 服务接口调用示例</p>
<h4 id="自定义-XML-格式"><a href="#自定义-XML-格式" class="headerlink" title="自定义 XML 格式"></a>自定义 XML 格式</h4><p>通用 API（外层报文）格式<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">interface</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.chinatax.gov.cn/tirip/dataspec/interfaces.xsd"</span> <span class="attr">version</span>=<span class="string">"DZFP1.0"</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">globalInfo</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--全局信息--&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">terminalCode</span>&gt;</span>终端类型标识(0:B/S 请求来源;1:C/S 请求来源)<span class="tag">&lt;/<span class="name">terminalCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">appId</span>&gt;</span>DZFP<span class="tag">&lt;/<span class="name">appId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>API 版本<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">interfaceCode</span>&gt;</span>API 编码<span class="tag">&lt;/<span class="name">interfaceCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">userName</span>&gt;</span>平台编码<span class="tag">&lt;/<span class="name">userName</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">passWord</span>&gt;</span>10 位随机数+Base64(&#123;（10 位随机数+注册码）MD5&#125;)<span class="tag">&lt;/<span class="name">passWord</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">taxpayerId</span>&gt;</span>纳税人识别号<span class="tag">&lt;/<span class="name">taxpayerId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">authorizationCode</span>&gt;</span>接入系统平台授权码（由平台提供）<span class="tag">&lt;/<span class="name">authorizationCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">requestCode</span>&gt;</span>数据交换请求发出方代码<span class="tag">&lt;/<span class="name">requestCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">requestTime</span>&gt;</span>数据交换请求发出时间<span class="tag">&lt;/<span class="name">requestTime</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">responseCode</span>&gt;</span>数据交换请求接受方代码<span class="tag">&lt;/<span class="name">responseCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">dataExchangeId</span>&gt;</span>数据交换流水号<span class="tag">&lt;/<span class="name">dataExchangeId</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">globalInfo</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">returnStateInfo</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--返回信息--&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">returnCode</span>&gt;</span>返回代码<span class="tag">&lt;/<span class="name">returnCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">returnMessage</span>&gt;</span>base64 返回描述<span class="tag">&lt;/<span class="name">returnMessage</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">returnStateInfo</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">Data</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--交换数据--&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">dataDescription</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--数据描述--&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">zipCode</span>&gt;</span>0,1<span class="tag">&lt;/<span class="name">zipCode</span>&gt;</span> (0,1 根据数据包大小判断是否进行压缩) </span><br><span class="line">      <span class="tag">&lt;<span class="name">encryptCode</span>&gt;</span>0,1,2<span class="tag">&lt;/<span class="name">encryptCode</span>&gt;</span>(三种加密方式代码，正式使用时通讯用 CA) </span><br><span class="line">      <span class="tag">&lt;<span class="name">codeType</span>&gt;</span>0,3DES,CA<span class="tag">&lt;/<span class="name">codeType</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataDescription</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">content</span>&gt;</span>base64 请求数据内容或返回数据内容<span class="tag">&lt;/<span class="name">content</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">Data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">interface</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
	
	</div>
  <a type="button" href="/2018/06/25/调用Http服务/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-24 </div>
			<div class="article-title"><a href="/2018/06/24/window删除多余启动项/" >window删除多余启动项</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>Win10 系统删除多余启动项,管理员打开 CMD</p>
<h4 id="列出存储中的项。"><a href="#列出存储中的项。" class="headerlink" title="列出存储中的项。"></a>列出存储中的项。</h4><p>bcdedit /enum</p>
<h4 id="删除存储中指定的操作系统项，并从显示顺序中删除该项。"><a href="#删除存储中指定的操作系统项，并从显示顺序中删除该项。" class="headerlink" title="删除存储中指定的操作系统项，并从显示顺序中删除该项。"></a>删除存储中指定的操作系统项，并从显示顺序中删除该项。</h4><p>bcdedit /delete {GUID} /cleanup</p>
<p>如：下列命令删除存储中指定的操作系统项，并从显示顺序中删除该项:</p>
<pre><code>bcdedit /delete {ca988616-ad03-11df-a70a-c417fef65b21} /cleanup
</code></pre>
	
	</div>
  <a type="button" href="/2018/06/24/window删除多余启动项/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-24 </div>
			<div class="article-title"><a href="/2018/06/24/并发编程中的原子性-可见性-有序性/" >并发编程中的原子性-可见性-有序性</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>并发编程中会遇到以下三个问题：原子性问题，可见性问题，有序性问题</p>
<h4 id="原子性"><a href="#原子性" class="headerlink" title="原子性"></a>原子性</h4><p>原子性：即一个操作或者多个操作 要么全部执行并且执行的过程不会被任何因素打断，要么就都不执行<br>一个很经典的例子就是银行账户转账问题：<br>　　比如从账户A向账户B转1000元，那么必然包括2个操作：从账户A减去1000元，往账户B加上1000元。</p>
<h4 id="可见性"><a href="#可见性" class="headerlink" title="可见性"></a>可见性</h4><p>可见性是指当多个线程访问同一个变量时，一个线程修改了这个变量的值，其他线程能够立即看得到修改的值<br>举个简单的例子，看下面这段代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//线程1执行的代码</span></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">i = <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//线程2执行的代码</span></span><br><span class="line">j = i;</span><br></pre></td></tr></table></figure></p>
<p>假若执行线程1的是CPU1，执行线程2的是CPU2。由上面的分析可知，当线程1执行 i=10这句时，<br>会先把i的初始值加载到CPU1的高速缓存中，然后赋值为10，那么在CPU1的高速缓存当中i的值变为10了，<br>却没有立即写入到主存当中， 此时线程2执行 j = i，它会先去主存读取i的值并加载到CPU2的缓存当中，<br>注意此时内存当中i的值还是0，那么就会使得j的值为0，而不是10.  这就是可见性问题，线程1对变量i修改了之后，<br>线程2没有立即看到线程1修改的值，这就是缓存不一致性问题</p>
<h4 id="有序性"><a href="#有序性" class="headerlink" title="有序性"></a>有序性</h4><p>有序性：即程序执行的顺序按照代码的先后顺序执行<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;              </span><br><span class="line"><span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">i = <span class="number">1</span>;                <span class="comment">//语句1  </span></span><br><span class="line">flag = <span class="keyword">true</span>;          <span class="comment">//语句2</span></span><br></pre></td></tr></table></figure></p>
<p>处理器为了提高程序运行效率，可能会对输入代码进行优化，它不保证程序中各个语句的执行先后顺序同代码中的顺序一致，<br>但是它会保证程序最终执行结果和代码顺序执行的结果是一致的,这就是指令重排序（Instruction Reorder）<br>语句1和语句2谁先执行对最终的程序结果并没有影响，那么就有可能在执行过程中，语句2先执行而语句1后执行。<br>因为处理器在进行重排序时是会考虑指令之间的数据依赖性，如果一个指令Instruction 2必须用到Instruction 1的结果，<br>那么处理器会保证Instruction 1会在Instruction 2之前执行<br><strong>重排序不会影响单个线程内程序执行的结果，但是多线程会影响</strong><br><code>`</code>Java<br>//线程1:<br>context = loadContext();   //语句1<br>inited = true;             //语句2</p>
<p>//线程2:<br>while(!inited ){<br>  sleep()<br>}<br>doSomethingwithconfig(context);<br><code>`</code>由于语句1和语句2没有数据依赖性，因此可能会被重排序。假如发生了重排序，在线程1执行过程中先执行语句2，<br>而此是线程2会以为初始化工作已经完成，那么就会跳出while循环，去执行doSomethingwithconfig(context)方法，<br>而此时context并没有被初始化，就会导致程序出错<br><strong>温馨总结：</strong><br>要想并发程序正确地执行，必须要保证原子性、可见性以及有序性。只要有一个没有被保证，就有可能会导致程序运行不正确</p>

	
	</div>
  <a type="button" href="/2018/06/24/并发编程中的原子性-可见性-有序性/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-24 </div>
			<div class="article-title"><a href="/2018/06/24/内存模型/" >内存模型</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h4 id="为什么-CPU-有调整缓存"><a href="#为什么-CPU-有调整缓存" class="headerlink" title="为什么 CPU 有调整缓存"></a>为什么 CPU 有调整缓存</h4><p>计算机在执行程序时，每条指令都是在CPU中执行的，而执行指令过程中，势必涉及到数据的读取和写入。<br>由于程序运行过程中的临时数据是存放在主存（物理内存）当中的，由于CPU执行速度很快，<br>而从内存读取数据和向内存写入数据的过程跟CPU执行指令的速度比起来要慢的多，因此如果任何时候对数据<br>的操作都要通过和内存的交互来进行，会大大降低指令执行的速度。因此在CPU里面就有了高速缓存。<br><strong>当程序在运行过程中，会将运算需要的数据从主存复制一份到CPU的高速缓存当中，那么CPU进行计算时就可以<br>直接从它的高速缓存读取数据和向其中写入数据，当运算结束之后，再将高速缓存中的数据刷新到主存当中</strong></p>
<h4 id="缓存一致性问题"><a href="#缓存一致性问题" class="headerlink" title="缓存一致性问题"></a>缓存一致性问题</h4><p>下面的这段代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i = i + <span class="number">1</span>;</span><br></pre></td></tr></table></figure></p>
<p>当线程执行这个语句时，会先从主存当中读取i的值，然后复制一份到高速缓存当中，然后CPU执行指令对i进行加1操作，<br>然后将数据写入高速缓存，最后将高速缓存中i最新的值刷新到主存当中。<br>在多线程中可能存在下面一种情况：初始时，两个线程分别读取i的值存入各自所在的CPU的高速缓存当中，<br>然后线程1进行加1操作，然后把i的最新值1写入到内存。此时线程2的高速缓存当中i的值还是0，进行加1操作之后，i的值为1 ，<br>然后线程2把i的值写入内存。最终结果i的值是1，而不是2。这就是缓存一致性问题。通常称这种被多个线程访问的变量为共享变量</p>
<h4 id="解决缓存不一致性问题"><a href="#解决缓存不一致性问题" class="headerlink" title="解决缓存不一致性问题"></a>解决缓存不一致性问题</h4><p>通常来说有以下2种解决方法：</p>
<ol>
<li>通过在总线加LOCK#锁的方式</li>
<li>通过缓存一致性协议<br>这2种方式都是硬件层面上提供的方式<br><strong>总线上加LOCK:</strong>因为CPU和其他部件进行通信都是通过总线来进行的，如果对总线加LOCK#锁，阻塞了其他CPU对其他部件<br>访问（如内存），从而使得只能有一个CPU能使用这个变量的内存<br><strong>缓存一致性协议:</strong><br>当CPU写数据时，如果发现操作的变量是共享变量，即在其他CPU中也存在该变量的副本，会发出信号通知其他CPU将该变量的<br>缓存行置为无效状态，因此当其他CPU需要读取这个变量时，发现自己缓存中缓存该变量的缓存行是无效的，<br>那么它就会从内存重新读取</li>
</ol>

	
	</div>
  <a type="button" href="/2018/06/24/内存模型/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-24 </div>
			<div class="article-title"><a href="/2018/06/24/单件模式/" >单件模式</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<ul>
<li>单件模式确保一个类最多只有一个实例，并提供一个全局访问点</li>
<li>Java 中实现单件模式需要私有的构造器、一个静态方法和一个静态变量<br>经典单件模式<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">    <span class="comment">// 利用一个静态变量来记录 Singleton类的唯一实例</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line">    <span class="comment">// 把构造器声明私有的，只有自 Singleton类内才可以调用构造器</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 用 getInstance 方法实例化对象，并返回这个实例</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(uniqueInstance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>如果多线程执行该代码，会产生多个对象，解决方法如下</p>
<h4 id="Method1-直接添加-synchronized"><a href="#Method1-直接添加-synchronized" class="headerlink" title="Method1 直接添加 synchronized"></a>Method1 直接添加 synchronized</h4><p>只要把 getInstance()变成同步 synchronized 方法即可<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(uniqueInstance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Method2-直接实例化"><a href="#Method2-直接实例化" class="headerlink" title="Method2 直接实例化"></a>Method2 直接实例化</h4><p>依赖 JVM 在加载这个类时马上创建此唯一的单件实例，JVM 保证在任何线程访问 uniqueInstance<br>静态变量之前，一定先创建此实例<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">    <span class="comment">// 在静态初始化器(tatic initializer)中创建单件，保证了线程安全</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Method3-双重检查加锁"><a href="#Method3-双重检查加锁" class="headerlink" title="Method3 双重检查加锁"></a>Method3 双重检查加锁</h4><p>在 getInstance()中减少使用同步,利用双重检查加锁(double-checked locking),首先检查<br>是否实例已经创建了，如果未创建才进行同步，这样只有第一次会同步<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 检查实例，如果不存在，就进入同步区块</span></span><br><span class="line">        <span class="keyword">if</span>(uniqueInstance == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">// 只有第一次才会彻底的执行这里的代码</span></span><br><span class="line">            <span class="keyword">synchronized</span>(Singleton.class)&#123;</span><br><span class="line">                <span class="comment">// 进入区块后，再检查一次，如果仍是 null，才创建实例</span></span><br><span class="line">                <span class="keyword">if</span>(uniqueInstance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                    uniqueInstance = <span class="keyword">new</span> Singleton();</span><br><span class="line">                &#125;    </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>volatile</strong> 关键字确保，当 uniqueInstance 变量被初始化成 Singleton时，多<br>个线程正确地处理 uniqueInstance 变量。</p>

	
	</div>
  <a type="button" href="/2018/06/24/单件模式/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-24 </div>
			<div class="article-title"><a href="/2018/06/24/恢复drop后的表/" >恢复drop后的表</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<h4 id="查看回收站中的表"><a href="#查看回收站中的表" class="headerlink" title="查看回收站中的表"></a>查看回收站中的表</h4><p>select object_name,original_name,partition_name,type,ts_name,createtime,droptime from recyclebin;</p>
<h4 id="恢复表"><a href="#恢复表" class="headerlink" title="恢复表"></a>恢复表</h4><p>flashback table “BIN$hgcd$0” to before drop;</p>

	
	</div>
  <a type="button" href="/2018/06/24/恢复drop后的表/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-04 </div>
			<div class="article-title"><a href="/2018/06/04/玛剧-心甘情愿/" >玛剧-心甘情愿</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>有人用一生的时间留着一个人，但是对方只用了一刹那就决定离开，永恒的爱情是来自单方面的心甘情愿。</p>

	
	</div>
  <a type="button" href="/2018/06/04/玛剧-心甘情愿/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-05-30 </div>
			<div class="article-title"><a href="/2018/05/30/装饰者模式-咖啡售卖/" >装饰者模式-咖啡售卖</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p>装饰者模式：动态地将责任附加到对象上，若要扩展功能，装饰者提供了比继承更有弹性的替代方案。<br>遵循的设计原则是：类应该对扩展开放，对修改关闭</p>
<ol>
<li>装饰者和被装饰对象有相同的类型</li>
<li>可以用一个或多个装饰者包装一个对象</li>
<li>在任何需要原始对象(被包装的)的场合，可以用装饰过的对象代替</li>
<li><p>对象可以在任何时候被装饰，可以在运行时动态地、不限量地用装饰者来装饰对象</p>
<p> <strong>咖啡种类</strong></p>
<p> 综合 HouseBlend<br> 深焙 DarkRoast<br> 低咖啡因 Decaf<br> 浓缩    Espresso</p>
<p> <strong>咖啡配料</strong></p>
<p>牛奶 Milk<br>摩卡 MoCha<br>豆浆 Soy<br>奶泡 Whip</p>
</li>
</ol>
<p>Bevarage抽象类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Bevarage 是一个抽象类，有两个方法 getgetDescription() 及 cost()</span></span><br><span class="line"><span class="comment"> * Created by randolph on 2018/5/29.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Beverage</span> </span>&#123;</span><br><span class="line">    String description = <span class="string">"Unknow Beverage"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> description;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
	
	</div>
  <a type="button" href="/2018/05/30/装饰者模式-咖啡售卖/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-05-26 </div>
			<div class="article-title"><a href="/2018/05/26/NIO/" >NIO</a></div>						
		</h3>
	


			<div class="entry">
  <div class="row">
	
	
		<p> 关于 Java NIO 的详解 <a href="https://blog.csdn.net/suifeng3051/article/details/48160753" target="_blank" rel="noopener">CSDN</a> 上有详细解释<br> NIO即新的输入输出，这个库是在JDK1.4中才引入的。它在标准java代码中提供了高速的面向块的IO操作</p>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ol>
<li>IO 输入输出<br> 使用流的方式来处理IO，所有的IO都被视作是单个字节的移动，通过stream对象一次移动一个字节，<br>流IO负责把对象与字节的相互转换</li>
<li>NIO (NEW IO)<br> 这个库是在JDK1.4中引入的。NIO和IO有相同的作用和目的，但实现方式不同，NIO主要用到的是块，<br>所以NIO的效率要比IO高很多<h3 id="流与块的比较"><a href="#流与块的比较" class="headerlink" title="流与块的比较"></a>流与块的比较</h3>NIO和IO最大的区别是数据打包和传输方式。IO是以流的方式处理数据，而NIO是以块的方式处理数据<br><strong>面向流的IO</strong> 一次一个字节的处理数据，一个输入流产生一个字节，一个输出流就消费一个字节,通常处理的很慢<br><strong>面向块的IO</strong> 系统以块的形式处理数据。每一个操作都在一步中产生或消费一个数据块。按块要比按流快的多
	
	</div>
  <a type="button" href="/2018/05/26/NIO/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">
<ul class="pagination">
	 
		
          <li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
        

        <li><a href="/"><i class="fa fa-home"></i>Home</a></li>

		
		   <li class="next"> <a href="/page/2/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a> </li>          
        
	
</ul>
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/Sql/">Sql<span>1</span></a></li>
		
			<li><a href="/tags/Design-Pattern/">Design Pattern<span>3</span></a></li>
		
			<li><a href="/tags/Vue/">Vue<span>2</span></a></li>
		
			<li><a href="/tags/SQL/">SQL<span>4</span></a></li>
		
			<li><a href="/tags/Java/">Java<span>2</span></a></li>
		
			<li><a href="/tags/Thread/">Thread<span>2</span></a></li>
		
			<li><a href="/tags/Essay/">Essay<span>10</span></a></li>
		
			<li><a href="/tags/CSS/">CSS<span>1</span></a></li>
		
			<li><a href="/tags/Invest/">Invest<span>2</span></a></li>
		
			<li><a href="/tags/POI/">POI<span>1</span></a></li>
		
			<li><a href="/tags/Linux/">Linux<span>4</span></a></li>
		
			<li><a href="/tags/WebService/">WebService<span>1</span></a></li>
		
			<li><a href="/tags/Io/">Io<span>1</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2018/06/27/sqlplus创建用户表空间赋权/" ><i class="fa fa-file-o"></i>sqlplus创建用户表空间赋权</a>
      </li>
    
      <li>
        <a href="/2018/06/25/调用Http服务/" ><i class="fa fa-file-o"></i>调用Http服务</a>
      </li>
    
      <li>
        <a href="/2018/06/24/window删除多余启动项/" ><i class="fa fa-file-o"></i>window删除多余启动项</a>
      </li>
    
      <li>
        <a href="/2018/06/24/并发编程中的原子性-可见性-有序性/" ><i class="fa fa-file-o"></i>并发编程中的原子性-可见性-有序性</a>
      </li>
    
      <li>
        <a href="/2018/06/24/内存模型/" ><i class="fa fa-file-o"></i>内存模型</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://bloom2036.github.io" title="Freemind's Github repository." target="_blank"]);">Bloom</a></li>
	
		<li><i class="fa fa-github"></i><a href="http://www.github.com/wzpan" title="My Github account." target="_blank"]);">My Github</a></li>
	
		<li><i class="fa fa-linkedin"></i><a href="http://www.linkedin.com/in/hahack" title="My Linkin account." target="_blank"]);">My LinkedIn</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->

	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2018 John Doe
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
