<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>调用Http服务 | Hexo</title>
  <meta name="author" content="John Doe">
  
  <meta name="description" content="http 服务接口调用示例
自定义 XML 格式通用 API（外层报文）格式123456789101112131415161718192021222324252627282930313233&amp;lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&amp;gt;&amp;lt;interfa">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="调用Http服务"/>
  <meta property="og:site_name" content="Hexo"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Hexo</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> 调用Http服务</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p> http 服务接口调用示例</p>
<h4 id="自定义-XML-格式"><a href="#自定义-XML-格式" class="headerlink" title="自定义 XML 格式"></a>自定义 XML 格式</h4><p>通用 API（外层报文）格式<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">interface</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.chinatax.gov.cn/tirip/dataspec/interfaces.xsd"</span> <span class="attr">version</span>=<span class="string">"DZFP1.0"</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">globalInfo</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--全局信息--&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">terminalCode</span>&gt;</span>终端类型标识(0:B/S 请求来源;1:C/S 请求来源)<span class="tag">&lt;/<span class="name">terminalCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">appId</span>&gt;</span>DZFP<span class="tag">&lt;/<span class="name">appId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>API 版本<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">interfaceCode</span>&gt;</span>API 编码<span class="tag">&lt;/<span class="name">interfaceCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">userName</span>&gt;</span>平台编码<span class="tag">&lt;/<span class="name">userName</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">passWord</span>&gt;</span>10 位随机数+Base64(&#123;（10 位随机数+注册码）MD5&#125;)<span class="tag">&lt;/<span class="name">passWord</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">taxpayerId</span>&gt;</span>纳税人识别号<span class="tag">&lt;/<span class="name">taxpayerId</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">authorizationCode</span>&gt;</span>接入系统平台授权码（由平台提供）<span class="tag">&lt;/<span class="name">authorizationCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">requestCode</span>&gt;</span>数据交换请求发出方代码<span class="tag">&lt;/<span class="name">requestCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">requestTime</span>&gt;</span>数据交换请求发出时间<span class="tag">&lt;/<span class="name">requestTime</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">responseCode</span>&gt;</span>数据交换请求接受方代码<span class="tag">&lt;/<span class="name">responseCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">dataExchangeId</span>&gt;</span>数据交换流水号<span class="tag">&lt;/<span class="name">dataExchangeId</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">globalInfo</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">returnStateInfo</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--返回信息--&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">returnCode</span>&gt;</span>返回代码<span class="tag">&lt;/<span class="name">returnCode</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">returnMessage</span>&gt;</span>base64 返回描述<span class="tag">&lt;/<span class="name">returnMessage</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">returnStateInfo</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">Data</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--交换数据--&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">dataDescription</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--数据描述--&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">zipCode</span>&gt;</span>0,1<span class="tag">&lt;/<span class="name">zipCode</span>&gt;</span> (0,1 根据数据包大小判断是否进行压缩) </span><br><span class="line">      <span class="tag">&lt;<span class="name">encryptCode</span>&gt;</span>0,1,2<span class="tag">&lt;/<span class="name">encryptCode</span>&gt;</span>(三种加密方式代码，正式使用时通讯用 CA) </span><br><span class="line">      <span class="tag">&lt;<span class="name">codeType</span>&gt;</span>0,3DES,CA<span class="tag">&lt;/<span class="name">codeType</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataDescription</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">content</span>&gt;</span>base64 请求数据内容或返回数据内容<span class="tag">&lt;/<span class="name">content</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">Data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">interface</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>dataDescription 描述如下<br>| 数据项 | 名称 | 类型 | 长度 | 说明 |<br>| - | :-: | :-: | :-: | :-: |<br>| zipCode | 压缩标识 | String | 1 | 0 不压缩 1 压缩 |<br>| encryptCode | 加密标识 | String | 1 | 0:不加密 1: 3DES 加密 2:CA |<br>| codeType | 加密方式 | String | 5 | 0 、3DES加密 、CA加密 |<br>交换数据内容(content)数据项说明<br>加密流程： BASE64.encode(ZIP压缩(CA加密 (xml明文)))<br>解密流程： CA解密(ZIP解压缩 (BASE64.decode(xml密文)))<br>Content 请求报文如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">REQUEST_FPKJXX</span> <span class="attr">class</span>=<span class="string">"REQUEST_FPKJXX"</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">FPKJXX_FPTXX</span> <span class="attr">class</span>=<span class="string">"FPKJXX_FPTXX"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">FPQQLSH</span>&gt;</span>发票请求唯一流水号<span class="tag">&lt;/<span class="name">FPQQLSH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">DSPTBM</span>&gt;</span>平台编码<span class="tag">&lt;/<span class="name">DSPTBM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">NSRSBH</span>&gt;</span>开票方识别号<span class="tag">&lt;/<span class="name">NSRSBH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">NSRMC</span>&gt;</span>开票方名称<span class="tag">&lt;/<span class="name">NSRMC</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">NSRDZDAH</span>&gt;</span>开票方电子档案号<span class="tag">&lt;/<span class="name">NSRDZDAH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">SWJG_DM</span>&gt;</span>税务机构代码<span class="tag">&lt;/<span class="name">SWJG_DM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">DKBZ</span>&gt;</span>代开标志<span class="tag">&lt;/<span class="name">DKBZ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">PYDM</span>&gt;</span>票样代码<span class="tag">&lt;/<span class="name">PYDM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">KPXM</span>&gt;</span>主要开票项目<span class="tag">&lt;/<span class="name">KPXM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">BMB_BBH</span>&gt;</span>编码表版本号<span class="tag">&lt;/<span class="name">BMB_BBH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">XHF_NSRSBH</span>&gt;</span>销货方识别号<span class="tag">&lt;/<span class="name">XHF_NSRSBH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">XHFMC</span>&gt;</span>销货方名称<span class="tag">&lt;/<span class="name">XHFMC</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">XHF_DZ</span>&gt;</span>销货方地址<span class="tag">&lt;/<span class="name">XHF_DZ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">XHF_DH</span>&gt;</span>销货方电话<span class="tag">&lt;/<span class="name">XHF_DH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">XHF_YHZH</span>&gt;</span>销货方银行账号<span class="tag">&lt;/<span class="name">XHF_YHZH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHFMC</span>&gt;</span>购货方名称<span class="tag">&lt;/<span class="name">GHFMC</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHF_NSRSBH</span>&gt;</span>购货方识别号<span class="tag">&lt;/<span class="name">GHF_NSRSBH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHF_SF</span>&gt;</span>购货方省份<span class="tag">&lt;/<span class="name">GHF_SF</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHF_DZ</span>&gt;</span>购货方地址<span class="tag">&lt;/<span class="name">GHF_DZ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHF_GDDH</span>&gt;</span>购货方固定电话<span class="tag">&lt;/<span class="name">GHF_GDDH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHF_SJ</span>&gt;</span>购货方手机<span class="tag">&lt;/<span class="name">GHF_SJ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHF_EMAIL</span>&gt;</span>购货方邮箱<span class="tag">&lt;/<span class="name">GHF_EMAIL</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHFQYLX</span>&gt;</span>01<span class="tag">&lt;/<span class="name">GHFQYLX</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">GHF_YHZH</span>&gt;</span>购货方银行、账号<span class="tag">&lt;/<span class="name">GHF_YHZH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">HY_DM</span>&gt;</span>行业代码<span class="tag">&lt;/<span class="name">HY_DM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">HY_MC</span>&gt;</span>行业名称<span class="tag">&lt;/<span class="name">HY_MC</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">KPY</span>&gt;</span>开票员<span class="tag">&lt;/<span class="name">KPY</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">SKY</span>&gt;</span>收款员<span class="tag">&lt;/<span class="name">SKY</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">FHR</span>&gt;</span>复核人<span class="tag">&lt;/<span class="name">FHR</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">KPRQ</span>&gt;</span>开票日期<span class="tag">&lt;/<span class="name">KPRQ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">KPLX</span>&gt;</span>开票类型<span class="tag">&lt;/<span class="name">KPLX</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">YFP_DM</span>&gt;</span>原发票代码<span class="tag">&lt;/<span class="name">YFP_DM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">YFP_HM</span>&gt;</span>原发票号码<span class="tag">&lt;/<span class="name">YFP_HM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">CZDM</span>&gt;</span>操作代码<span class="tag">&lt;/<span class="name">CZDM</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">QD_BZ</span>&gt;</span>清单标志<span class="tag">&lt;/<span class="name">QD_BZ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">QDXMMC</span>&gt;</span>清单发票项目名称<span class="tag">&lt;/<span class="name">QDXMMC</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">CHYY</span>&gt;</span>冲红原因<span class="tag">&lt;/<span class="name">CHYY</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">TSCHBZ</span>&gt;</span>特殊冲红标志<span class="tag">&lt;/<span class="name">TSCHBZ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">KPHJJE</span>&gt;</span>价税合计金额<span class="tag">&lt;/<span class="name">KPHJJE</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">HJBHSJE</span>&gt;</span>合计不含税金额<span class="tag">&lt;/<span class="name">HJBHSJE</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">HJSE</span>&gt;</span>合计税额<span class="tag">&lt;/<span class="name">HJSE</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">BZ</span>&gt;</span>备注<span class="tag">&lt;/<span class="name">BZ</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">BYZD1</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD1</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">BYZD2</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD2</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">BYZD3</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD3</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">BYZD4</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD4</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">BYZD5</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD5</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">FPKJXX_FPTXX</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">FPKJXX_XMXXS</span> <span class="attr">class</span>=<span class="string">"FPKJXX_XMXX;"</span> <span class="attr">size</span>=<span class="string">"1"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">FPKJXX_XMXX</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">XMMC</span>&gt;</span>项目名称<span class="tag">&lt;/<span class="name">XMMC</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">XMDW</span>&gt;</span>项目单位<span class="tag">&lt;/<span class="name">XMDW</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">GGXH</span>&gt;</span>规格型号<span class="tag">&lt;/<span class="name">GGXH</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">XMSL</span>&gt;</span>项目数量<span class="tag">&lt;/<span class="name">XMSL</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">HSBZ</span>&gt;</span>含税标志<span class="tag">&lt;/<span class="name">HSBZ</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">XMDJ</span>&gt;</span>项目单价<span class="tag">&lt;/<span class="name">XMDJ</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">FPHXZ</span>&gt;</span>发票行性质<span class="tag">&lt;/<span class="name">FPHXZ</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">SPBM</span>&gt;</span>商品编码<span class="tag">&lt;/<span class="name">SPBM</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">ZXBM</span>&gt;</span>自行编码<span class="tag">&lt;/<span class="name">ZXBM</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">YHZCBS</span>&gt;</span>优惠政策标识<span class="tag">&lt;/<span class="name">YHZCBS</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">LSLBS</span>&gt;</span>零税率标识<span class="tag">&lt;/<span class="name">LSLBS</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">ZZSTSGL</span>&gt;</span>增值税特殊管理<span class="tag">&lt;/<span class="name">ZZSTSGL</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">KCE</span>&gt;</span>扣除额<span class="tag">&lt;/<span class="name">KCE</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">XMJE</span>&gt;</span>项目金额<span class="tag">&lt;/<span class="name">XMJE</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">SL</span>&gt;</span>税率<span class="tag">&lt;/<span class="name">SL</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">SE</span>&gt;</span>税额<span class="tag">&lt;/<span class="name">SE</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">BYZD1</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD1</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">BYZD2</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD2</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">BYZD3</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD3</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">BYZD4</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD4</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">BYZD5</span>&gt;</span>备用字段<span class="tag">&lt;/<span class="name">BYZD5</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">FPKJXX_XMXX</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">FPKJXX_XMXXS</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">FPKJXX_DDXX</span> <span class="attr">class</span>=<span class="string">"FPKJXX_DDXX"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">DDH</span>&gt;</span>订单号<span class="tag">&lt;/<span class="name">DDH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">THDH</span>&gt;</span>退货单号<span class="tag">&lt;/<span class="name">THDH</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">DDDATE</span>&gt;</span>订单时间<span class="tag">&lt;/<span class="name">DDDATE</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">FPKJXX_DDXX</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">REQUEST_FPKJXX</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="ElectronicInvoiceController类"><a href="#ElectronicInvoiceController类" class="headerlink" title="ElectronicInvoiceController类"></a>ElectronicInvoiceController类</h4><p>ElectronicInvoiceController 类如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/electronicInvoice"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ElectronicInvoiceController</span> <span class="keyword">extends</span> <span class="title">PageController</span>&lt;<span class="title">TransactionHistory</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">//private static final String WSDLADDRESS_HTTP = "http://fw1test.shdzfp.com:9000/sajt-shdzfp-sl-http/SvrServlet"; // test</span></span><br><span class="line">	 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String WSDLADDRESS_HTTP = <span class="string">"http://112.65.253.4:9012/sajt-shdzfp-sl-http/SvrServlet"</span>;</span><br><span class="line">	<span class="comment">// XML node 位置</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String RETURNCODE = <span class="string">"/interface/returnStateInfo/returnCode"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String RETURNMESSAGE = <span class="string">"/interface/returnStateInfo/returnMessage"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CONTENT = <span class="string">"/interface/Data/content"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ZIPCODE = <span class="string">"/interface/Data/dataDescription/zipCode"</span>; <span class="comment">// 0-不压缩 , 1 压缩</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ENCRYPTCODE = <span class="string">"/interface/Data/dataDescription/encryptCode"</span>; <span class="comment">// 0-不压缩 , 1 压缩</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PDF_FILE =<span class="string">"REQUEST_FPKJXX_FPJGXX_NEW/PDF_FILE"</span>; <span class="comment">//pdf 文件路径</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String FP_DM =<span class="string">"REQUEST_FPKJXX_FPJGXX_NEW/FP_DM"</span>; <span class="comment">//发票代码</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String FP_HM =<span class="string">"REQUEST_FPKJXX_FPJGXX_NEW/FP_HM"</span>; <span class="comment">//发票号码</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String KPRQ =<span class="string">"REQUEST_FPKJXX_FPJGXX_NEW/KPRQ"</span>; <span class="comment">//发票开票日期</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// private static final String INVOICE_SAVE_PATH="E://";</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INVOICE_SAVE_PATH=<span class="string">"/ys/"</span>;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> TransactionHistoryManager transactionHistoryManager;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> MemberManager memberManager;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> ElectronicInvoiceManager electronicInvoiceManager;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 开发票</span></span><br><span class="line"><span class="comment">     *  fpqqlsh 流水号</span></span><br><span class="line"><span class="comment">	    ghf_nsrsbh 购货方识别号(学员企业)</span></span><br><span class="line"><span class="comment">	    ghfmc  填写学员名字或 对方单位名称</span></span><br><span class="line"><span class="comment">	    ghfqylx 购货方企业类型 01：企业    02：机关事业单位    03：个人    04：其它</span></span><br><span class="line"><span class="comment">	    xmdj 项目单价</span></span><br><span class="line"><span class="comment">	    xmje 项目金额  设置成和单价一样</span></span><br><span class="line"><span class="comment">	    invoiceType   开票类型： 0-个人开票   1-企业开票</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/fpkj"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  String <span class="title">fpkj</span><span class="params">(HttpServletRequest request, @RequestParam(<span class="string">"fpqqlsh"</span>)</span> String fpqqlsh,</span></span><br><span class="line"><span class="function">    		 @<span class="title">RequestParam</span><span class="params">(<span class="string">"ghfmc"</span>)</span> String ghfmc, @<span class="title">RequestParam</span><span class="params">(<span class="string">"ghf_nsrsbh"</span>)</span> String ghf_nsrsbh,</span></span><br><span class="line"><span class="function">    		 @<span class="title">RequestParam</span><span class="params">(<span class="string">"ghfqylx"</span>)</span> String ghfqylx, </span></span><br><span class="line"><span class="function">    		 @<span class="title">RequestParam</span><span class="params">(<span class="string">"xmje"</span>)</span> String xmje,ModelMap modelMap,</span></span><br><span class="line"><span class="function">    		 @<span class="title">RequestParam</span><span class="params">(<span class="string">"objectId"</span>)</span> String objectId,</span></span><br><span class="line"><span class="function">    		 @<span class="title">RequestParam</span><span class="params">(<span class="string">"invoiceType"</span>)</span> Integer invoiceType) </span>&#123;</span><br><span class="line">    	TransactionHistory tran = transactionHistoryManager.getByObjectId(Long.valueOf(objectId));  </span><br><span class="line">        String xmdj = xmje;</span><br><span class="line">		XmlTemplate xmlTemplate = <span class="keyword">new</span> XmlTemplate();</span><br><span class="line">		<span class="comment">// 拼接 通用 globleInfo</span></span><br><span class="line">		String globleInfo = xmlTemplate.getGlobleInfoByInterfaceCode(<span class="string">"FPKJ"</span>);</span><br><span class="line">		<span class="comment">// 拼接 content 中的明文</span></span><br><span class="line">		<span class="comment">// System.out.println(fpqqlsh);</span></span><br><span class="line">		String ghfsj =request.getParameter(<span class="string">"ghfsj"</span>);</span><br><span class="line">		String content = xmlTemplate.getFpkjContentByInterfaceCode(fpqqlsh, ghfmc, ghf_nsrsbh, ghfqylx, xmdj, xmje,ghfsj);</span><br><span class="line">		<span class="comment">// 加密 content</span></span><br><span class="line">		String contentEncrypted = xmlTemplate.encryptContent(content);</span><br><span class="line">		<span class="comment">// 整个 xml = globleInfo + contentEncrypted</span></span><br><span class="line">		String soapXml = xmlTemplate.getFullXmlEncryptedString(globleInfo,contentEncrypted);</span><br><span class="line">		<span class="comment">// 接口调用</span></span><br><span class="line">		<span class="comment">// tran.setInvoiceFlag(0); // test use</span></span><br><span class="line">		String returnResult=<span class="string">""</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">null</span> ==tran.getInvoiceFlag())&#123;</span><br><span class="line">			String response = HttpClientCallSoapUtil.doPostSoap(WSDLADDRESS_HTTP, soapXml);</span><br><span class="line">			Document doc =xmlTemplate.StringTOXml(response);</span><br><span class="line">			String returnVal=xmlTemplate.getNodeValue(doc, RETURNCODE);</span><br><span class="line">			String returnMessageVal=xmlTemplate.getNodeValue(doc, RETURNMESSAGE);</span><br><span class="line">			DesUtil desUtil = <span class="keyword">new</span> DesUtil();</span><br><span class="line">			<span class="keyword">byte</span>[] bResult = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				bResult = desUtil.getBase64DecString(returnMessageVal);</span><br><span class="line">				returnResult = <span class="keyword">new</span> String(bResult,<span class="string">"utf-8"</span>);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			 modelMap.addAttribute(<span class="string">"returnCode"</span>, returnVal);</span><br><span class="line">			 modelMap.addAttribute(<span class="string">"returnMessage"</span>, returnResult);</span><br><span class="line">			<span class="comment">// System.out.println(returnResult);</span></span><br><span class="line">		 </span><br><span class="line">			<span class="keyword">if</span> (returnVal.equals(<span class="string">"0000"</span>)) &#123;</span><br><span class="line">				<span class="comment">// 返回 returnCode 0000  成功才会修改 invoiceFlag 内容</span></span><br><span class="line">				tran.setInvoiceFlag(<span class="number">0</span>);</span><br><span class="line">				tran.setInvoiceType(invoiceType);</span><br><span class="line">				tran.setGhfqylx(ghfqylx);</span><br><span class="line">				<span class="comment">// person</span></span><br><span class="line">				<span class="keyword">if</span>(invoiceType == <span class="number">0</span>)&#123;</span><br><span class="line">					transactionHistoryManager.update(tran, <span class="string">"invoiceFlag"</span>,<span class="string">"invoiceType"</span>,<span class="string">"ghfqylx"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">// enterprise</span></span><br><span class="line">				<span class="keyword">if</span>(invoiceType == <span class="number">1</span>)&#123;</span><br><span class="line">					tran.setNsrsbh(ghf_nsrsbh);</span><br><span class="line">					tran.setGhfmc(ghfmc);</span><br><span class="line">					transactionHistoryManager.update(tran, <span class="string">"invoiceFlag"</span>,<span class="string">"invoiceType"</span>,<span class="string">"ghfqylx"</span>,<span class="string">"nsrsbh"</span>,<span class="string">"ghfmc"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			modelMap.addAttribute(<span class="string">"returnCode"</span>, <span class="string">"0000"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		modelMap.addAttribute(<span class="string">"ddh"</span>, fpqqlsh);</span><br><span class="line">		modelMap.addAttribute(<span class="string">"fpqqlsh"</span>, xmlTemplate.getUSERNAME()+fpqqlsh);</span><br><span class="line">		<span class="comment">/***********************/</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"jsonView"</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="XmlTemplate-类"><a href="#XmlTemplate-类" class="headerlink" title="XmlTemplate 类"></a>XmlTemplate 类</h4><p>XmlTemplate 类如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipInputStream;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilderFactory;</span><br><span class="line"><span class="keyword">import</span> javax.xml.xpath.XPath;</span><br><span class="line"><span class="keyword">import</span> javax.xml.xpath.XPathExpressionException;</span><br><span class="line"><span class="keyword">import</span> javax.xml.xpath.XPathFactory;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Document;</span><br><span class="line"><span class="keyword">import</span> com.mvc.invoice.util.DesUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XmlTemplate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 不同 API 编码不一样 ， 需要动态调用</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; interfaceCodeMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 初始化O</span></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		interfaceCodeMap.put(<span class="string">"FPKJ"</span>, <span class="string">"ECXML.FPKJ.BC.E_INV"</span>);</span><br><span class="line">		interfaceCodeMap.put(<span class="string">"FPXZ"</span>, <span class="string">"ECXML.FPXZ.CX.E_INV"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String TERMINALCODE = <span class="string">"0"</span>; <span class="comment">// 终端类型标识(0:B/S 请求来源;1:C/S 请求来源</span></span><br><span class="line">	<span class="keyword">private</span> String APPID = <span class="string">"ZZS_PT_DZFP"</span>; <span class="comment">// DZFP 表示普通发票。ZZS_PT_DZFP 表示增值税普通电子发票</span></span><br><span class="line">	<span class="keyword">private</span> String VERSION = <span class="string">"1.0"</span>; <span class="comment">// API 版本,当前 1.0</span></span><br><span class="line"></span><br><span class="line">	 <span class="keyword">private</span> String USERNAME = <span class="string">"testing"</span>; <span class="comment">// 平台编码, 事先取得从管理端（请求前）test 111MFWIK;  药师 P0000391</span></span><br><span class="line">	 <span class="keyword">private</span> String PASSWORD =<span class="string">""</span>;																<span class="comment">// 事先取得从管理端（请求前）</span></span><br><span class="line">	<span class="keyword">private</span> String SERIALNUM = <span class="string">"eXl4EymmJ"</span>;</span><br><span class="line">	<span class="keyword">private</span> String REQUESTCODE = <span class="string">"testing"</span>; <span class="comment">// 数据交换请求发起方代码 ,用平台编码</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String TAXPAYERID = <span class="string">"51310000501778371C"</span>; <span class="comment">// 纳税人识别号 test 310101000000090 ;</span></span><br><span class="line">	<span class="keyword">private</span> String AUTHORIZATIONCODE = <span class="string">"70MP0I49BH"</span>; <span class="comment">// 纳税人授权码, 事先取得从平台系统获取（请求前) test 3100000090  ；药师 	70MP0I49BH</span></span><br><span class="line">	<span class="keyword">private</span> String RESPONSECODE = <span class="string">"121"</span>; <span class="comment">// 数据交换请求接受方代码</span></span><br><span class="line">	<span class="keyword">private</span> String ZIPCODE_NO_COMPRESS = <span class="string">"0"</span>; <span class="comment">// 压缩标识 0 不压缩 1 压缩</span></span><br><span class="line">	<span class="keyword">private</span> String ZIPCODE_COMPRESS = <span class="string">"1"</span>; <span class="comment">// 压缩标识 0 不压缩 1 压缩</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String ENCRYPTCODE_NO = <span class="string">"0"</span>;<span class="comment">// 加密标识 0:不加密 1: 3DES 加密 2:CA</span></span><br><span class="line">	<span class="keyword">private</span> String ENCRYPTCODE_3DES = <span class="string">"1"</span>;<span class="comment">// 加密标识 0:不加密 1: 3DES 加密 2:CA</span></span><br><span class="line">	<span class="keyword">private</span> String ENCRYPTCODE_CA = <span class="string">"2"</span>;<span class="comment">// 加密标识 0:不加密 1: 3DES 加密 2:CA</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String CODETYPE = <span class="string">"0"</span>;</span><br><span class="line">	<span class="keyword">private</span> String CODETYPE_3DES = <span class="string">"3DES"</span>;</span><br><span class="line">	<span class="keyword">private</span> String CODETYPE_CA = <span class="string">"CA"</span>;</span><br><span class="line">	<span class="comment">/********************************</span></span><br><span class="line"><span class="comment">	 * GlobalInfo End</span></span><br><span class="line"><span class="comment">	 *********************************************************/</span></span><br><span class="line">	<span class="keyword">private</span> String NSRSBH = <span class="string">"51310000501778371C"</span>; </span><br><span class="line">	 <span class="keyword">private</span> String NSRMC = <span class="string">"上海市执业药师协会"</span>; </span><br><span class="line">	<span class="keyword">private</span> String DKBZ = <span class="string">"0"</span>; <span class="comment">// 自开(0) 代开(1)</span></span><br><span class="line">	<span class="keyword">private</span> String KPXM = <span class="string">"继续教育培训费"</span>; <span class="comment">// 继续教育培训费 ,test 化妆品</span></span><br><span class="line">	<span class="keyword">private</span> String BMB_BBH = <span class="string">"12.0"</span>; <span class="comment">// 12.0 now</span></span><br><span class="line">	<span class="keyword">private</span> String XHF_NSRSBH = <span class="string">"51310000501778371C"</span>; <span class="comment">// </span></span><br><span class="line">	<span class="keyword">private</span> String XHFMC = <span class="string">"上海市执业药师协会"</span>; <span class="comment">// </span></span><br><span class="line">	<span class="keyword">private</span> String XHF_DZ = <span class="string">"上海市柳州路615号2号楼3楼"</span>; </span><br><span class="line">	<span class="keyword">private</span> String XHF_DH = <span class="string">"64516320"</span>; <span class="comment">// test 213132 ; 64516320</span></span><br><span class="line">	<span class="keyword">private</span> String KPY = <span class="string">"殷晓梅"</span>; <span class="comment">// test 财务一 ; 药师 </span></span><br><span class="line">	<span class="keyword">private</span> String KPLX_Z = <span class="string">"1"</span>; <span class="comment">// 开票类型 1 正票 2 红票</span></span><br><span class="line">	<span class="keyword">private</span> String KPLX_H = <span class="string">"2"</span>; <span class="comment">// 开票类型 1 正票 2 红票</span></span><br><span class="line">	<span class="keyword">private</span> String CZDM_Z = <span class="string">"10"</span>; <span class="comment">// 10正票正常开具 20退货折让红票</span></span><br><span class="line">	<span class="keyword">private</span> String CZDM_H = <span class="string">"20"</span>; <span class="comment">// 10正票正常开具 20退货折让红票</span></span><br><span class="line">	<span class="comment">/***************************** FPTXX End *******************************/</span></span><br><span class="line">	<span class="keyword">private</span> String XMMC = <span class="string">"继续教育培训费"</span>; </span><br><span class="line">	<span class="keyword">private</span> String HSBZ = <span class="string">"1"</span>; <span class="comment">// 0 表示都不含税，1 表示都含税。</span></span><br><span class="line">	<span class="keyword">private</span> String FPHXZ = <span class="string">"0"</span>; <span class="comment">// 0正常行 1折扣行 2被折扣行。 test 2 ； 药师 0</span></span><br><span class="line">	<span class="comment">//private String SPBM_TEST = "1010101030000000000"; </span></span><br><span class="line">	<span class="keyword">private</span> String SPBM = <span class="string">"3070201020000000000"</span>; </span><br><span class="line">	<span class="keyword">private</span> String SL = <span class="string">"0.03"</span>; <span class="comment">// test 0.17 ; ys 0.03</span></span><br><span class="line">	<span class="comment">/******************************************</span></span><br><span class="line"><span class="comment">	 * XMXX End</span></span><br><span class="line"><span class="comment">	 *****************************************/</span></span><br><span class="line">	<span class="keyword">private</span> String KEYBYTES = <span class="string">"==testing testing=="</span>; </span><br><span class="line"></span><br><span class="line">	<span class="comment">/****************************************** End *****************************************/</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 拼接通用 XML 头信息</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> interfaceCode</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getGlobleInfoByInterfaceCode</span><span class="params">(String interfaceCode)</span> </span>&#123;</span><br><span class="line">		DateFormat format = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"YYYY-MM-DD HH:mm:ss"</span>);</span><br><span class="line">		DateFormat mat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"YYYYMMDD"</span>);</span><br><span class="line">		Date date = <span class="keyword">new</span> Date();</span><br><span class="line">		StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		sb.append(<span class="string">"&lt;?xml version=\'1.0\' encoding=\'UTF-8\'?&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">" &lt;interface xmlns:xsi=\'http://www.w3.org/2001/XMLSchema-instance\'"</span>);</span><br><span class="line">		sb.append(<span class="string">" xsi:schemaLocation=\'http://www.chinatax.gov.cn/tirip/dataspec/interfaces.xsd\'"</span>);</span><br><span class="line">		sb.append(<span class="string">" version=\'DZFP1.0\'&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">" &lt;globalInfo&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;terminalCode&gt;"</span>);</span><br><span class="line">		sb.append(TERMINALCODE);</span><br><span class="line">		sb.append(<span class="string">"&lt;/terminalCode&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;appId&gt;"</span>);</span><br><span class="line">		sb.append(APPID);</span><br><span class="line">		sb.append(<span class="string">"&lt;/appId&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;version&gt;"</span>);</span><br><span class="line">		sb.append(VERSION);</span><br><span class="line">		sb.append(<span class="string">"&lt;/version&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;interfaceCode&gt;"</span>);</span><br><span class="line">		sb.append(interfaceCodeMap.get(interfaceCode).toString());</span><br><span class="line">		sb.append(<span class="string">"&lt;/interfaceCode&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;requestCode&gt;"</span>);</span><br><span class="line">		sb.append(REQUESTCODE);</span><br><span class="line">		sb.append(<span class="string">"&lt;/requestCode&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"	&lt;requestTime&gt;"</span>);</span><br><span class="line">		sb.append(format.format(date));</span><br><span class="line">		sb.append(<span class="string">"&lt;/requestTime&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;responseCode&gt;"</span>);</span><br><span class="line">		sb.append(RESPONSECODE);</span><br><span class="line">		sb.append(<span class="string">"&lt;/responseCode&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;dataExchangeId&gt;"</span>);</span><br><span class="line">		sb.append(USERNAME).append(interfaceCodeMap.get(interfaceCode).toString()).append(mat.format(date))</span><br><span class="line">				.append(SERIALNUM);</span><br><span class="line">		sb.append(<span class="string">"&lt;/dataExchangeId&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;userName&gt;"</span>);</span><br><span class="line">		sb.append(USERNAME);</span><br><span class="line">		sb.append(<span class="string">"&lt;/userName&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;passWord&gt;"</span>);</span><br><span class="line">		sb.append(PASSWORD);</span><br><span class="line">		sb.append(<span class="string">"&lt;/passWord&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;taxpayerId&gt;"</span>);</span><br><span class="line">		sb.append(TAXPAYERID);</span><br><span class="line">		sb.append(<span class="string">"&lt;/taxpayerId&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;authorizationCode&gt;"</span>);</span><br><span class="line">		sb.append(AUTHORIZATIONCODE);</span><br><span class="line">		sb.append(<span class="string">"&lt;/authorizationCode&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;/globalInfo&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;returnStateInfo&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;returnCode/&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;returnMessage/&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;/returnStateInfo&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;Data&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;dataDescription&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;zipCode&gt;"</span>);</span><br><span class="line">		sb.append(ZIPCODE_NO_COMPRESS);</span><br><span class="line">		sb.append(<span class="string">"&lt;/zipCode&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;encryptCode&gt;"</span>);</span><br><span class="line">		 sb.append(ENCRYPTCODE_3DES);<span class="comment">// 正式</span></span><br><span class="line">		sb.append(<span class="string">"&lt;/encryptCode&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;codeType&gt;"</span>);</span><br><span class="line">		<span class="comment">// sb.append(CODETYPE);  // test</span></span><br><span class="line">		sb.append(CODETYPE_3DES); <span class="comment">// 正式</span></span><br><span class="line">		sb.append(<span class="string">"&lt;/codeType&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;/dataDescription&gt;"</span>);</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 开发票 fpqqlsh 流水号 ghf_nsrsbh 购货方识别号(学员企业) ghfmc 填写学员名字或 对方单位名称 ghfqylx</span></span><br><span class="line"><span class="comment">	 * 购货方企业类型 01：企业 02：机关事业单位 03：个人 04：其它 xmdj 项目单价 xmje 项目金额 设置成和单价一样；  手机号 ghfsj</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFpkjContentByInterfaceCode</span><span class="params">(String fpqqlsh, String ghfmc, String ghf_nsrsbh, String ghfqylx,</span></span></span><br><span class="line"><span class="function"><span class="params">			String xmdj, String xmje,String ghfsj)</span> </span>&#123;</span><br><span class="line">		StringBuilder sbContent = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		<span class="comment">// sbContent.append("&lt;CONTENT&gt;");</span></span><br><span class="line">		sbContent.append(<span class="string">"&lt;REQUEST_FPKJXX class=\"REQUEST_FPKJXX\"&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FPKJXX_FPTXX class=\"FPKJXX_FPTXX\"&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FPQQLSH&gt;"</span>);</span><br><span class="line">		sbContent.append(USERNAME).append(fpqqlsh);</span><br><span class="line">		<span class="comment">//sbContent.append(fpqqlsh);</span></span><br><span class="line">		sbContent.append(<span class="string">"&lt;/FPQQLSH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;DSPTBM&gt;"</span>);</span><br><span class="line">		sbContent.append(USERNAME);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/DSPTBM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(NSRSBH);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;NSRMC&gt;"</span>);</span><br><span class="line">		sbContent.append(NSRMC);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/NSRMC&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;NSRDZDAH&gt;&lt;/NSRDZDAH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;SWJG_DM&gt;&lt;/SWJG_DM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;DKBZ&gt;"</span>);</span><br><span class="line">		sbContent.append(DKBZ);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/DKBZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;PYDM&gt;&lt;/PYDM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;KPXM&gt;"</span>);</span><br><span class="line">		sbContent.append(KPXM);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/KPXM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BMB_BBH&gt;"</span>);</span><br><span class="line">		sbContent.append(BMB_BBH);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/BMB_BBH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XHF_NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(XHF_NSRSBH);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/XHF_NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XHFMC&gt;"</span>);</span><br><span class="line">		sbContent.append(XHFMC);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/XHFMC&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XHF_DZ&gt;"</span>);</span><br><span class="line">		sbContent.append(XHF_DZ);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/XHF_DZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XHF_DH&gt;"</span>);</span><br><span class="line">		sbContent.append(XHF_DH);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/XHF_DH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XHF_YHZH&gt;&lt;/XHF_YHZH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHFMC&gt;"</span>);</span><br><span class="line">		sbContent.append(ghfmc); <span class="comment">//</span></span><br><span class="line">		sbContent.append(<span class="string">"&lt;/GHFMC&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHF_NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(ghf_nsrsbh);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/GHF_NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHF_SF&gt;&lt;/GHF_SF&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHF_DZ&gt;"</span>);</span><br><span class="line">			sbContent.append(<span class="keyword">null</span>==ghfsj ? <span class="string">""</span> : ghfsj);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/GHF_DZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHF_GDDH&gt;&lt;/GHF_GDDH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHF_SJ&gt;&lt;/GHF_SJ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHF_EMAIL&gt;&lt;/GHF_EMAIL&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHFQYLX&gt;"</span>);</span><br><span class="line">		sbContent.append(ghfqylx);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/GHFQYLX&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GHF_YHZH&gt;&lt;/GHF_YHZH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;HY_DM&gt;&lt;/HY_DM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;HY_MC&gt;&lt;/HY_MC&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;KPY&gt;"</span>);</span><br><span class="line">		sbContent.append(KPY);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/KPY&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;SKY&gt;&lt;/SKY&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FHR&gt;&lt;/FHR&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;KPRQ&gt;&lt;/KPRQ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;KPLX&gt;"</span>);</span><br><span class="line">		sbContent.append(KPLX_Z);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/KPLX&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;YFP_DM&gt;&lt;/YFP_DM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;YFP_HM&gt;&lt;/YFP_HM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;CZDM&gt;"</span>);</span><br><span class="line">		sbContent.append(CZDM_Z);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/CZDM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;QD_BZ&gt;0&lt;/QD_BZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;QDXMMC&gt;&lt;/QDXMMC&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;CHYY&gt;&lt;/CHYY&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;TSCHBZ&gt;&lt;/TSCHBZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;KPHJJE&gt;0&lt;/KPHJJE&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;HJBHSJE&gt;0&lt;/HJBHSJE&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;HJSE&gt;0&lt;/HJSE&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BZ&gt;&lt;/BZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD1&gt;&lt;/BYZD1&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD2&gt;&lt;/BYZD2&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD3&gt;&lt;/BYZD3&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD4&gt;&lt;/BYZD4&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD5&gt;&lt;/BYZD5&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/FPKJXX_FPTXX&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FPKJXX_XMXXS class=\"FPKJXX_XMXX;\" size=\"1\"&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FPKJXX_XMXX&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XMMC&gt;"</span>);</span><br><span class="line">		sbContent.append(XMMC);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/XMMC&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XMDW&gt;&lt;/XMDW&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;GGXH&gt;&lt;/GGXH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XMSL&gt;&lt;/XMSL&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;HSBZ&gt;"</span>);</span><br><span class="line">		sbContent.append(HSBZ);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/HSBZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FPHXZ&gt;"</span>);</span><br><span class="line">		sbContent.append(FPHXZ);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/FPHXZ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XMDJ&gt;"</span>);</span><br><span class="line">		sbContent.append(xmdj);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/XMDJ&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;SPBM&gt;"</span>);</span><br><span class="line">		sbContent.append(SPBM);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/SPBM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;ZXBM&gt;&lt;/ZXBM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;YHZCBS&gt;0&lt;/YHZCBS&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;LSLBS&gt;&lt;/LSLBS&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;ZZSTSGL&gt;&lt;/ZZSTSGL&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;KCE&gt;&lt;/KCE&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;XMJE&gt;"</span>);</span><br><span class="line">		sbContent.append(xmje);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/XMJE&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;SL&gt;"</span>);</span><br><span class="line">		sbContent.append(SL);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/SL&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;SE&gt;&lt;/SE&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD1&gt;&lt;/BYZD1&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD2&gt;&lt;/BYZD2&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD3&gt;&lt;/BYZD3&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD4&gt;&lt;/BYZD4&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;BYZD5&gt;&lt;/BYZD5&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/FPKJXX_XMXX&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/FPKJXX_XMXXS&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FPKJXX_DDXX class=\"FPKJXX_DDXX\"&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;DDH&gt;"</span>);</span><br><span class="line">		sbContent.append(fpqqlsh);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/DDH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;THDH /&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;DDDATE /&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/FPKJXX_DDXX&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/REQUEST_FPKJXX&gt;"</span>);</span><br><span class="line">		<span class="keyword">return</span> sbContent.toString();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 加密 Content</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> content</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">encryptContent</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">		DesUtil desUtil = <span class="keyword">new</span> DesUtil();</span><br><span class="line">		<span class="keyword">byte</span>[] data = <span class="keyword">null</span>;</span><br><span class="line">		String encryptContent = <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			data = desUtil.getStringByte(content);</span><br><span class="line">			<span class="comment">// CA 加密生产用</span></span><br><span class="line">			  data = desUtil.des3EncodeECB(KEYBYTES.getBytes(<span class="string">"UTF-8"</span>), data);</span><br><span class="line">			<span class="comment">// Base64 加密</span></span><br><span class="line">			encryptContent = desUtil.getBase64EncString(data);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// bash64 加密 content</span></span><br><span class="line">		<span class="keyword">return</span> encryptContent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFullXmlEncryptedString</span><span class="params">(String globleInfo, String encryptContent)</span> </span>&#123;</span><br><span class="line">		StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		sb.append(globleInfo);</span><br><span class="line">		sb.append(<span class="string">"&lt;content&gt;"</span>);</span><br><span class="line">		sb.append(encryptContent);</span><br><span class="line">		sb.append(<span class="string">"&lt;/content&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;/Data&gt;"</span>);</span><br><span class="line">		sb.append(<span class="string">"&lt;/interface&gt;"</span>);</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> xml形状的str串</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> Document 对象</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Document <span class="title">StringTOXml</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">		DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();</span><br><span class="line">		Document doc = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			InputStream is = <span class="keyword">new</span> ByteArrayInputStream(str.getBytes(<span class="string">"utf-8"</span>));</span><br><span class="line">			doc = dbf.newDocumentBuilder().parse(is);</span><br><span class="line">			is.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> doc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> document</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 某个节点的值 前提是需要知道xml格式，知道需要取的节点相对根节点所在位置</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getNodeValue</span><span class="params">(Document document, String nodePaht)</span> </span>&#123;</span><br><span class="line">		XPathFactory xpfactory = XPathFactory.newInstance();</span><br><span class="line">		XPath path = xpfactory.newXPath();</span><br><span class="line">		String servInitrBrch = <span class="string">""</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			servInitrBrch = path.evaluate(nodePaht, document);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (XPathExpressionException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> servInitrBrch;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 发票数据下载</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> fpqqlsh</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> ghfmc</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> ghf_nsrsbh</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> ghfqylx</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> xmdj</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> xmje</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getFpxzContentByInterfaceCode</span><span class="params">(String fpqqlsh, String ddh)</span> </span>&#123;</span><br><span class="line">		StringBuilder sbContent = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		<span class="comment">// sbContent.append("&lt;CONTENT&gt;");</span></span><br><span class="line">		sbContent.append(<span class="string">"&lt;REQUEST_FPXXXZ_NEW class=\"REQUEST_FPXXXZ_NEW\"&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;FPQQLSH&gt;"</span>);</span><br><span class="line">		sbContent.append(fpqqlsh);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/FPQQLSH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;DSPTBM&gt;"</span>);</span><br><span class="line">		sbContent.append(USERNAME);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/DSPTBM&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(NSRSBH);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/NSRSBH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;DDH&gt;"</span>);</span><br><span class="line">		sbContent.append(ddh);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/DDH&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;PDF_XZFS&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"1"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/PDF_XZFS&gt;"</span>);</span><br><span class="line">		sbContent.append(<span class="string">"&lt;/REQUEST_FPXXXZ_NEW&gt;"</span>);</span><br><span class="line">		<span class="comment">// sbContent.append("&lt;/CONTENT&gt;");</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> sbContent.toString();</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="comment">// getter  and setter method  omit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="加解密工具类"><a href="#加解密工具类" class="headerlink" title="加解密工具类"></a>加解密工具类</h4><p>DesUtil 类如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPInputStream;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESedeKeySpec;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DesUtil</span> </span>&#123;</span><br><span class="line">	 <span class="comment">/**</span></span><br><span class="line"><span class="comment">	  * 【Java使用3DES加密解密的流程】</span></span><br><span class="line"><span class="comment">		    ①传入共同约定的密钥（keyBytes）以及算法（Algorithm），来构建SecretKey密钥对象</span></span><br><span class="line"><span class="comment">		        SecretKey deskey = new SecretKeySpec(keyBytes, Algorithm);    </span></span><br><span class="line"><span class="comment">		    ②根据算法实例化Cipher对象。它负责加密/解密</span></span><br><span class="line"><span class="comment">		        Cipher c1 = Cipher.getInstance(Algorithm);    </span></span><br><span class="line"><span class="comment">		    ③传入加密/解密模式以及SecretKey密钥对象，实例化Cipher对象</span></span><br><span class="line"><span class="comment">		        c1.init(Cipher.ENCRYPT_MODE, deskey);    </span></span><br><span class="line"><span class="comment">		    ④传入字节数组，调用Cipher.doFinal()方法，实现加密/解密，并返回一个byte字节数组</span></span><br><span class="line"><span class="comment">        c1.doFinal(src);</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">	  */</span></span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">final</span> Base64 base64 = <span class="keyword">new</span> Base64();</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	 <span class="comment">/**</span></span><br><span class="line"><span class="comment">	  *  base64 encrypt</span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@param</span> strMing</span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@throws</span> UnsupportedEncodingException</span></span><br><span class="line"><span class="comment">	  */</span></span><br><span class="line">	 <span class="function"><span class="keyword">public</span> String <span class="title">getBase64EncString</span><span class="params">(<span class="keyword">byte</span>[] strMingByte)</span> <span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line">		 String encodedText = base64.encodeToString(strMingByte);</span><br><span class="line">		 <span class="keyword">return</span> encodedText;</span><br><span class="line">	 &#125;</span><br><span class="line">	 <span class="comment">/**</span></span><br><span class="line"><span class="comment">	  *  base64 decrypt</span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@param</span> encodedText</span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	  * <span class="doctag">@throws</span> UnsupportedEncodingException</span></span><br><span class="line"><span class="comment">	  */</span></span><br><span class="line">	 <span class="keyword">public</span> <span class="keyword">byte</span>[] getBase64DecString(String encodedText) <span class="keyword">throws</span> UnsupportedEncodingException  &#123;</span><br><span class="line">		<span class="keyword">return</span> base64.decode(encodedText);</span><br><span class="line">	 &#125;</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">byte</span>[] getStringByte(String strMing) <span class="keyword">throws</span> UnsupportedEncodingException&#123;</span><br><span class="line">		<span class="keyword">return</span> strMing.getBytes(<span class="string">"UTF-8"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	  </span><br><span class="line">	  <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * ECB加密,不要IV</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@param</span> key 密钥</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@param</span> data 明文</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@return</span> Base64编码的密文</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">public</span>  <span class="keyword">byte</span>[] des3EncodeECB(<span class="keyword">byte</span>[] key, <span class="keyword">byte</span>[] data)</span><br><span class="line">	            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	        Key deskey = <span class="keyword">null</span>;</span><br><span class="line">	        DESedeKeySpec spec = <span class="keyword">new</span> DESedeKeySpec(key);</span><br><span class="line">	        SecretKeyFactory keyfactory = SecretKeyFactory.getInstance(<span class="string">"desede"</span>);</span><br><span class="line">	        deskey = keyfactory.generateSecret(spec);</span><br><span class="line">	        Cipher cipher = Cipher.getInstance(<span class="string">"desede"</span> + <span class="string">"/ECB/PKCS5Padding"</span>);</span><br><span class="line">	        cipher.init(Cipher.ENCRYPT_MODE, deskey);</span><br><span class="line">	        <span class="keyword">byte</span>[] bOut = cipher.doFinal(data);</span><br><span class="line">	        <span class="keyword">return</span> bOut;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	     * ECB解密,不要IV</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@param</span> key 密钥</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@param</span> data Base64编码的密文</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@return</span> 明文</span></span><br><span class="line"><span class="comment">	     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">	     */</span></span><br><span class="line">	    <span class="keyword">public</span>  <span class="keyword">byte</span>[] ees3DecodeECB(<span class="keyword">byte</span>[] key, <span class="keyword">byte</span>[] data)</span><br><span class="line">	            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">	        Key deskey = <span class="keyword">null</span>;</span><br><span class="line">	        DESedeKeySpec spec = <span class="keyword">new</span> DESedeKeySpec(key);</span><br><span class="line">	        SecretKeyFactory keyfactory = SecretKeyFactory.getInstance(<span class="string">"desede"</span>);</span><br><span class="line">	        deskey = keyfactory.generateSecret(spec);</span><br><span class="line">	        Cipher cipher = Cipher.getInstance(<span class="string">"desede"</span> + <span class="string">"/ECB/PKCS5Padding"</span>);</span><br><span class="line">	        cipher.init(Cipher.DECRYPT_MODE, deskey);</span><br><span class="line">	        <span class="keyword">byte</span>[] bOut = cipher.doFinal(data);</span><br><span class="line">	        <span class="keyword">return</span> bOut;</span><br><span class="line">	    &#125;</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * zip解压</span></span><br><span class="line"><span class="comment">		 * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">		 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="keyword">public</span>  <span class="keyword">byte</span>[] unGZip(<span class="keyword">byte</span>[] data) &#123;</span><br><span class="line">			<span class="keyword">byte</span>[] b = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				ByteArrayInputStream bis = <span class="keyword">new</span> ByteArrayInputStream(data);</span><br><span class="line">				GZIPInputStream gzip = <span class="keyword">new</span> GZIPInputStream(bis);</span><br><span class="line">				<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">				<span class="keyword">int</span> num = -<span class="number">1</span>;</span><br><span class="line">				ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">				<span class="keyword">while</span> ((num = gzip.read(buf, <span class="number">0</span>, buf.length)) != -<span class="number">1</span>) &#123;</span><br><span class="line">					baos.write(buf, <span class="number">0</span>, num);</span><br><span class="line">				&#125;</span><br><span class="line">				b = baos.toByteArray();</span><br><span class="line">				baos.flush();</span><br><span class="line">				baos.close();</span><br><span class="line">				gzip.close();</span><br><span class="line">				bis.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">				ex.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> b;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * </span></span><br><span class="line"><span class="comment">		 * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">		 * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">		 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">		 * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span>  String <span class="title">ees3encodeECB</span><span class="params">(String key, String data)</span></span></span><br><span class="line"><span class="function">				<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">			 Key deskey = <span class="keyword">null</span>;</span><br><span class="line">	         DESedeKeySpec spec = <span class="keyword">new</span> DESedeKeySpec(key.getBytes(<span class="string">"UTF-8"</span>));</span><br><span class="line">	         SecretKeyFactory keyfactory = SecretKeyFactory.getInstance(<span class="string">"desede"</span>);</span><br><span class="line">	         deskey = keyfactory.generateSecret(spec);</span><br><span class="line">	         Cipher cipher = Cipher.getInstance(<span class="string">"desede"</span> + <span class="string">"/ECB/PKCS5Padding"</span>);</span><br><span class="line">	         cipher.init(Cipher.ENCRYPT_MODE, deskey);</span><br><span class="line">	         <span class="keyword">byte</span>[] bOut = cipher.doFinal(data.getBytes(<span class="string">"UTF-8"</span>));</span><br><span class="line">	         sun.misc.BASE64Encoder encoder=<span class="keyword">new</span> sun.misc.BASE64Encoder();       </span><br><span class="line">	         <span class="keyword">return</span> encoder.encode(bOut);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		  * 将base64字符解码保存文件</span></span><br><span class="line"><span class="comment">		  * <span class="doctag">@param</span> base64Code</span></span><br><span class="line"><span class="comment">		  * <span class="doctag">@param</span> targetPath</span></span><br><span class="line"><span class="comment">		  * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">		  */</span></span><br><span class="line"></span><br><span class="line">		 <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">decoderBase64File</span><span class="params">(String base64Code, String targetPath)</span></span></span><br><span class="line"><span class="function">		   <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		  <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> BASE64Decoder().decodeBuffer(base64Code);</span><br><span class="line">		  FileOutputStream out = <span class="keyword">new</span> FileOutputStream(targetPath);</span><br><span class="line">		  out.write(buffer);</span><br><span class="line">		  out.close();</span><br><span class="line"></span><br><span class="line">		 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="HttpClientCallSoapUtil类"><a href="#HttpClientCallSoapUtil类" class="headerlink" title="HttpClientCallSoapUtil类"></a>HttpClientCallSoapUtil类</h4><p>HttpClientCallSoapUtil 类如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mvc.invoice.util;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.http.HttpEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.config.RequestConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpPost;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.entity.StringEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.HttpClientBuilder;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.util.EntityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 基于HttpClient的Soap的工具类</span></span><br><span class="line"><span class="comment">* 1. 创建HttpClient对象。</span></span><br><span class="line"><span class="comment">* 2. 创建请求方法的实例，并指定请求URL。如果需要发送GET请求，创建HttpGet对象；如果需要发送POST请求，创建HttpPost对象。</span></span><br><span class="line"><span class="comment">* 3. 如果需要发送请求参数，可调用HttpGet、HttpPost共同的setParams(HetpParams params)方法来添加请求参数；</span></span><br><span class="line"><span class="comment">*       对于HttpPost对象而言，也可调用setEntity(HttpEntity entity)方法来设置请求参数。</span></span><br><span class="line"><span class="comment">* 4. 调用HttpClient对象的execute(HttpUriRequest request)发送请求，该方法返回一个HttpResponse。</span></span><br><span class="line"><span class="comment">* 5. 调用HttpResponse的getAllHeaders()、getHeaders(String name)等方法可获取服务器的响应头；调用HttpResponse的getEntity()方法</span></span><br><span class="line"><span class="comment">*   可获取HttpEntity对象，该对象包装了服务器的响应内容.</span></span><br><span class="line"><span class="comment">* 程序可通过该对象获取服务器的响应内容。</span></span><br><span class="line"><span class="comment">6. 释放连接。无论执行方法是否成功，都必须释放连接</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpClientCallSoapUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> socketTimeout = <span class="number">30000</span>;<span class="comment">// 请求超时时间</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> connectTimeout = <span class="number">30000</span>;<span class="comment">// 传输超时时间</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用SOAP发送消息</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postUrl 请求地址</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> soapXml 发送包的字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 响应结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">doPostSoap</span><span class="params">(String postUrl, String soapXml)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//响应结果字符串</span></span><br><span class="line">        String respStr = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            HttpClientBuilder httpClientBuilder = HttpClientBuilder.create();</span><br><span class="line">            CloseableHttpClient closeableHttpClient = httpClientBuilder.build();</span><br><span class="line">            HttpPost httpPost = <span class="keyword">new</span> HttpPost(postUrl);</span><br><span class="line">            <span class="comment">//  设置请求和传输超时时间</span></span><br><span class="line">            RequestConfig requestConfig = RequestConfig.custom()</span><br><span class="line">                    .setSocketTimeout(socketTimeout)</span><br><span class="line">                    .setConnectTimeout(connectTimeout).build();</span><br><span class="line">            httpPost.setConfig(requestConfig);</span><br><span class="line">            httpPost.setHeader(<span class="string">"Content-Type"</span>, <span class="string">"text/xml;charset=UTF-8"</span>);</span><br><span class="line">            StringEntity data = <span class="keyword">new</span> StringEntity(soapXml,</span><br><span class="line">                    Charset.forName(<span class="string">"UTF-8"</span>));</span><br><span class="line">            httpPost.setEntity(data);</span><br><span class="line">            CloseableHttpResponse response = closeableHttpClient</span><br><span class="line">                    .execute(httpPost);</span><br><span class="line">            HttpEntity httpEntity = response.getEntity();</span><br><span class="line">            <span class="keyword">if</span> (httpEntity != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 打印响应内容</span></span><br><span class="line">                respStr = EntityUtils.toString(httpEntity, <span class="string">"UTF-8"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 释放资源</span></span><br><span class="line">            closeableHttpClient.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> respStr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
		
          <li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
        

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2018/06/24/window删除多余启动项/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
        
    <div class="bdsharebuttonbox">
        <a href="#" class="bds_more" data-cmd="more"></a>
        <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
        <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
        <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
        <a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
        <a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a>
        <a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a>
        <a href="#" class="bds_copy" data-cmd="copy" title="分享到复制网址"></a>
    </div>
    <script>
        window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{}};
        with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>


        

    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">Comments</h2>

  
</section>

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2018-06-25 
	</div>
	

	<!-- categories -->
    

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/WebService/">WebService<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2018 John Doe
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
